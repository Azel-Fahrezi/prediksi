{% extends 'base.html' %}
{% block content %}
<h3>Unggah File CSV</h3>
<!-- Form Unggah -->
<form action="{{ url_for('index') }}" method="POST" enctype="multipart/form-data">
    <div class="form-group">
        <label for="file">Pilih File CSV:</label>
        <input type="file" name="file" class="form-control" required>
    </div>
    <div class="d-flex align-items-center gap-2 mt-2">
        <button type="submit" name="action" value="upload" class="btn btn-primary">Unggah</button>
        {% if file_uploaded %}
        <form action="{{ url_for('delete_file', file_name=filename) }}" method="POST" style="display:inline;">
            <button type="submit" class="btn btn-danger">Batal</button>
        </form>
        {% endif %}
    </div>
</form>

<!-- Tampilkan Data Jika File Sudah Diupload -->
{% if file_uploaded %}
    <hr>
    <h3>Data Training</h3>
    <div class="table-responsive">
        {{ table_html|safe }}
    </div>

    <!-- Tombol Navigasi Halaman -->
    <div class="d-flex justify-content-between mt-3">
        {% if has_prev %}
            <a href="{{ url_for('paginate', page=page-1) }}" class="btn btn-secondary">Sebelumnya</a>
        {% else %}
            <span class="btn btn-secondary disabled">Sebelumnya</span>
        {% endif %}
        
        {% if has_next %}
            <a href="{{ url_for('paginate', page=page+1) }}" class="btn btn-secondary">Selanjutnya</a>
        {% else %}
            <span class="btn btn-secondary disabled">Selanjutnya</span>
        {% endif %}
    </div>

    <hr>
    <div class="d-flex align-items-center gap-2">
        <form action="{{ url_for('delete_file', file_name=filename) }}" method="POST" style="display:inline;">
            <button type="submit" class="btn btn-danger">Hapus File</button>
        </form>
        <h8>File: {{ filename }}</h8>
    </div>    

    <!-- Form Input Parameter Training -->
    <hr>
    <h3>Parameter Training</h3>
    <form action="{{ url_for('testing') }}" method="POST">
        <div class="form-group">
            <label for="Jumlah_Stok">Jumlah Stok:</label>
            <input type="number" name="Jumlah_Stok" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="Musim_Periodik">Musim Periodik:</label>
            <select name="Musim_Periodik" class="form-control" required>
                <option value="Normal">Normal</option>
                <option value="Liburan">Liburan</option>
                <option value="Musim Flu">Musim Flu</option>
            </select>
        </div>        
        <div class="form-group">
            <label for="Penjualan_Sebelumnya">Penjualan Sebelumnya:</label>
            <input type="number" name="Penjualan_Sebelumnya" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="max_iter">Maksimal Iterasi:</label>
            <input type="number" name="max_iter" class="form-control" value="500" required>
        </div>
        <div class="form-group">
            <label for="target_accuracy">Target Akurasi (%):</label>
            <input type="number" step="0.01" name="target_accuracy" class="form-control" value="95.0" required>
        </div>
        <button type="submit" class="btn btn-primary">Proses Training</button>
    </form>
{% endif %}
{% endblock %}